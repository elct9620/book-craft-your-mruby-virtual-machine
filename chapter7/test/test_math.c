#include "test_math.h"

void test_opcode_loadi() {
  const uint8_t bin[] = {
    /**
     * # Ruby Code
     * 99
     */
    0x52,0x49,0x54,0x45,0x30,0x30,0x30,0x37,0x01,0xfa,0x00,0x00,0x00,0x46,0x4d,0x41,
    0x54,0x5a,0x30,0x30,0x30,0x30,0x49,0x52,0x45,0x50,0x00,0x00,0x00,0x28,0x30,0x30,
    0x30,0x32,0x00,0x00,0x00,0x32,0x00,0x01,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x06,
    0x03,0x01,0x63,0x37,0x01,0x67,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x4e,
    0x44,0x00,0x00,0x00,0x00,0x08,
  };

  int ret = mrb_exec(bin + 34);

  TEST_ASSERT_EQUAL_UINT32(99, ret);
}

void test_opcode_loadineg() {
  const uint8_t bin[] = {
    /**
     * # Ruby Code
     * -101
     */
    0x52,0x49,0x54,0x45,0x30,0x30,0x30,0x37,0x89,0x07,0x00,0x00,0x00,0x46,0x4d,0x41,
    0x54,0x5a,0x30,0x30,0x30,0x30,0x49,0x52,0x45,0x50,0x00,0x00,0x00,0x28,0x30,0x30,
    0x30,0x32,0x00,0x00,0x00,0x32,0x00,0x01,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x06,
    0x04,0x01,0x65,0x37,0x01,0x67,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x4e,
    0x44,0x00,0x00,0x00,0x00,0x08,
  };

  int ret = mrb_exec(bin + 34);

  TEST_ASSERT_EQUAL_UINT32(-101, ret);
}

void test_opcode_loadi__1() {
  const uint8_t bin[] = {
    /**
     * # Ruby Code
     * -1
     */
    0x52,0x49,0x54,0x45,0x30,0x30,0x30,0x37,0xca,0xaa,0x00,0x00,0x00,0x45,0x4d,0x41,
    0x54,0x5a,0x30,0x30,0x30,0x30,0x49,0x52,0x45,0x50,0x00,0x00,0x00,0x27,0x30,0x30,
    0x30,0x32,0x00,0x00,0x00,0x2e,0x00,0x01,0x00,0x02,0x00,0x00,0x00,0x00,0x00,0x05,
    0x05,0x01,0x37,0x01,0x67,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x45,0x4e,0x44,
    0x00,0x00,0x00,0x00,0x08,
  };

  int ret = mrb_exec(bin + 34);

  TEST_ASSERT_EQUAL_UINT32(-1, ret);
}
