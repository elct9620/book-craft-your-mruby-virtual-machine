#include "test_vm.h"

void test_mrb_exec() {
  const uint8_t bin[] = {
    // mrbc -B bin add.rb
    0x52,0x49,0x54,0x45,0x30,0x30,0x30,0x37,0xb7,0xd2,0x00,0x00,0x00,0x48,0x4d,0x41,
    0x54,0x5a,0x30,0x30,0x30,0x30,0x49,0x52,0x45,0x50,0x00,0x00,0x00,0x2a,0x30,0x30,
    0x30,0x32,0x00,0x00,0x00,0x3a,0x00,0x01,0x00,0x04,0x00,0x00,0x00,0x00,0x00,0x08,
    0x07,0x01,0x3c,0x01,0x01,0x37,0x01,0x67,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
    0x45,0x4e,0x44,0x00,0x00,0x00,0x00,0x08
  };

  int ret = mrb_exec(bin + 34);

  TEST_ASSERT_EQUAL_UINT32(2, ret);
}
